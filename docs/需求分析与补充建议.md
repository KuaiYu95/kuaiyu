# 需求分析与补充建议

## 一、项目概述

### 1.1 核心需求

**前台功能**

- React SSR 部署，极简暗黑风格
- 中英文国际化（next-intl），居中布局（最大宽度 800px）
- 完整页面：首页、博客、生活、归档、类别、留言
- RSS 订阅链接、埋点统计、评论系统

**后台功能**

- React CSR + Vite，MUI 组件库（size=small）
- 博客/生活记录发布流程，Markdown 编辑器
- 数据统计图表（Recharts），配置管理

**技术架构**

- 后端：Go（Gin + GORM）
- 前台：Next.js 14+ SSR
- 后台：React 18+ CSR
- 数据库：MySQL 8.0+
- 部署：Docker Compose + Nginx
- 域名：kcat.site

> 详细技术方案请参考 `技术方案.md`

## 二、已确定的技术选型

### 2.1 后端技术栈

- **语言**: Go
- **框架**: Gin
- **ORM**: GORM
- **认证**: JWT
- **API 文档**: Swagger (swaggo/swag)

### 2.2 前台技术栈

- **框架**: Next.js 14+ (App Router)
- **国际化**: next-intl
- **样式**: Tailwind CSS
- **动画**: Framer Motion + React Spring
- **Markdown**: react-markdown + highlight.js
- **HTTP**: Axios

### 2.3 后台技术栈

- **框架**: React 18+ + Vite
- **UI 库**: Material-UI (MUI) v5+ (size=small)
- **路由**: React Router v6
- **Markdown 编辑器**: @uiw/react-md-editor
- **图表库**: Recharts
- **表单**: React Hook Form + Zod
- **状态管理**: Zustand

### 2.4 部署配置

- **域名**: kcat.site
- **SSL**: Let's Encrypt
- **服务器建议**: 2 核 4G 内存，20G 硬盘（初期足够）

## 三、已确定的功能决策

### 3.1 订阅功能

- ✅ 仅支持 RSS 订阅链接
- ❌ 不提供邮件通知功能

### 3.2 评论系统

- ✅ **审核策略**: 首次评论需要审核，后续自动通过
- ✅ **回复层级**: 所有回复一个层级（parent_id 指向主评论）
- ✅ **回复排序**: 按时间排序
- ✅ **回复展示**: 默认展示 3 条，点击"查看更多"展示全部
- ✅ **生活记录**: 支持评论和回复，与博客一致

### 3.3 归档页面

- ✅ 不支持按年份筛选
- ✅ 全部展示所有文章

## 四、功能优先级规划

### 4.1 高优先级（必须实现）

1. ✅ **基础功能**

   - 博客文章管理（发布、编辑、删除）
   - 生活记录管理
   - 评论系统（评论、回复、审核）

2. ✅ **后台管理**

   - 登录认证
   - 内容发布流程
   - 配置管理（网站信息、Footer 配置）

3. ✅ **安全防护**

   - JWT 认证
   - 数据加密
   - 接口限流
   - 安全头设置

4. ✅ **SEO 优化（完美支持）**

   - **Meta 标签配置**

     - title, description, keywords（每页独立）
     - Open Graph 标签（社交媒体分享）
     - Twitter Card 标签
     - 多语言支持（hreflang）

   - **结构化数据 (JSON-LD)**

     - Article, Blog, Person, BreadcrumbList
     - WebSite, Organization

   - **Sitemap 自动生成**

     - 包含所有已发布内容
     - 支持多语言版本
     - 定期自动更新

   - **robots.txt 配置**

     - 允许搜索引擎爬取
     - 指定 sitemap 位置

   - **语义化 HTML**

     - 正确的 HTML5 语义标签
     - 合理的标题层级

   - **URL 优化**

     - 友好的 URL 结构（slug）
     - 静态化 URL
     - 多语言 URL 支持

   - **性能优化（影响 SEO）**
     - 快速首屏加载
     - SSR 服务端渲染
     - 图片优化
   - 结构化数据

5. ✅ **埋点统计**

   - 前端埋点 SDK
   - 访问统计（PV、UV）
   - 事件追踪

6. ✅ **RSS 订阅**

   - RSS Feed 生成（XML）
   - 支持 RSS 阅读器订阅

7. ✅ **数据备份**
   - 自动备份数据库
   - 一键恢复功能

### 4.2 中优先级（推荐实现）

1. 🔶 **搜索功能**

   - 站内搜索（前端搜索或后端全文搜索）

2. 🔶 **统计图表**

   - 后台数据可视化（访问趋势、设备分布、热门内容）

3. 🔶 **评论审核机制**

   - 垃圾评论检测
   - 敏感词过滤
   - IP 频率限制

4. 🔶 **图片管理优化**
   - 图片库管理
   - 图片压缩
   - WebP 格式支持

### 4.3 低优先级（可选实现）

1. 🔹 **文章置顶功能**
2. 🔹 **监控告警**（Sentry、性能监控）
3. 🔹 **CI/CD**（自动化部署）
4. 🔹 **测试覆盖**（单元测试、E2E）
5. 🔹 **无障碍访问**（ARIA、键盘导航）

## 五、开发阶段规划

### 5.1 第一阶段：基础搭建（2-3 周）

**目标**: 完成核心功能框架

**任务清单**:

- [ ] 数据库设计与初始化
- [ ] 后端 API 开发（Go + Gin + GORM）
  - 认证模块（登录、JWT）
  - 博客模块（CRUD）
  - 评论模块（基础功能）
- [ ] 前台核心页面
  - 首页
  - 博客列表页
  - 博客详情页
- [ ] 后台基础功能
  - 登录页面
  - 博客管理（列表、编辑）
- [ ] 评论系统基础功能

**交付物**: 可用的博客系统（基础功能）

### 5.2 第二阶段：功能完善（2-3 周）

**目标**: 完善所有核心功能

**任务清单**:

- [ ] 前台完整页面
  - 生活记录列表/详情
  - 归档页面
  - 类别页面
  - 留言页面
- [ ] 后台完整功能
  - 生活记录管理
  - 评论管理（审核、回复）
  - 配置管理（网站配置、Footer 配置）
- [ ] SEO 优化（完美支持）
  - Meta 标签配置（title, description, OG, Twitter Card）
  - 结构化数据（JSON-LD）
  - Sitemap 自动生成（多语言）
  - robots.txt 配置
  - 语义化 HTML
  - URL 优化
  - 性能优化（影响 SEO）
- [ ] 埋点系统
  - 前端埋点 SDK
  - 数据上报接口
- [ ] RSS 订阅
  - RSS Feed 生成
- [ ] 图片上传
  - 腾讯云 COS 集成
  - Markdown 编辑器图片上传

**交付物**: 功能完整的博客系统

### 5.3 第三阶段：统计与优化（1-2 周）

**目标**: 数据统计与性能优化

**任务清单**:

- [ ] 访问统计功能
  - 页面访问记录
  - 统计数据查询
- [ ] 后台统计图表
  - 仪表盘设计
  - 访问趋势图
  - 设备/浏览器分布图
  - 热门内容统计
- [ ] 性能优化
  - 缓存策略
  - CDN 配置
  - 图片优化
- [ ] 安全加固
  - 安全头设置
  - 接口限流
  - 数据验证

**交付物**: 性能优化、数据统计完整的系统

### 5.4 第四阶段：部署与测试（1-2 周）

**目标**: 部署上线

**任务清单**:

- [ ] Docker 部署配置
  - docker-compose.yml
  - Dockerfile（各服务）
- [ ] Nginx 配置
  - 反向代理
  - SSL 配置
  - 静态资源缓存
- [ ] SSL 证书配置
  - Let's Encrypt 证书申请
  - 自动续期配置
- [ ] 数据备份方案
  - 自动备份脚本
  - 备份验证
- [ ] 功能测试
  - 功能测试
  - 性能测试
  - 安全测试
- [ ] 部署文档编写
  - 部署步骤文档
  - 一键部署脚本

**交付物**: 可上线部署的系统

### 5.5 第五阶段：增强功能（可选，1-2 周）

**目标**: 增强用户体验

**任务清单**:

- [ ] 搜索功能
  - 前端搜索或后端全文搜索
- [ ] 评论审核优化
  - 垃圾评论检测算法
  - 敏感词库
- [ ] 其他增强功能
  - 根据实际需求添加

**交付物**: 功能增强的系统

## 六、项目总结

### 6.1 技术栈总结

- **后端**: Go (Gin + GORM)
- **前台**: Next.js 14+ SSR
- **后台**: React 18+ CSR (Vite)
- **数据库**: MySQL 8.0+
- **部署**: Docker Compose + Nginx
- **域名**: kcat.site

### 6.2 核心功能总结

- ✅ 博客文章管理
- ✅ 生活记录管理
- ✅ 评论系统（单层回复）
- ✅ RSS 订阅
- ✅ 埋点统计
- ✅ 数据可视化
- ✅ SEO 优化
- ✅ 数据备份

### 6.3 开发周期

- **预计总时长**: 6-10 周
- **核心功能**: 4-6 周
- **优化与部署**: 2-4 周

### 6.4 开发建议

1. **优先级**: 严格按照优先级顺序开发，先完成高优先级功能
2. **分阶段**: 分阶段开发，每个阶段都有明确的交付物
3. **安全**: 注重安全防护，从开发初期就考虑安全问题
4. **性能**: 性能优化贯穿整个开发过程
5. **文档**: 及时更新文档，保持文档与代码同步
6. **测试**: 关键功能需要测试，确保质量

> 详细技术实现请参考：
>
> - `技术方案.md` - 完整技术方案（包含功能、接口、数据库设计）
> - `UI设计大纲.md` - UI 设计规范（包含页面设计、动效、错误状态）
> - `数据库备份与迁移指南.md` - 数据库备份与迁移文档
